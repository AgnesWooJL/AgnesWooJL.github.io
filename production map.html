
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Coffee Environment Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://js.arcgis.com/4.32/esri/themes/light/main.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://s3.tradingview.com/tv.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css" />
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://js.arcgis.com/4.32/"></script>
  <!-- Load Calcite components from CDN -->
  <script type="module" src="https://js.arcgis.com/calcite-components/3.0.3/calcite.esm.js"></script>
  <!-- Load Map components from CDN-->
  <script
  type="module"
  src="https://js.arcgis.com/map-components/4.32/arcgis-map-components.esm.js"
  ></script> 
  
  
  
    <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    #viewDiv {
      width: 100%;
      height: 100%;
    }
      body {
      font-family: Arial, sans-serif;

    }
    .section-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: #6f4e37;
    }
    .section-text {
      font-size: 0.95rem;
      line-height: 1.6;
      color: #333;
      margin-bottom: 1.5rem;
    }
      .icon-label {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-weight: 500;
    }
    .timeline::before {
      content: "";
      position: absolute;
      left: 16px;
      top: 0;
      bottom: 0;
      width: 2px;
      background-color: #d2b48c;
    }
    
          }
        #timeSliderDiv {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            z-index: 10;
        }
        #layerControls {
            position: absolute;
            top: 10px;
            right: 500px;
            z-index: 100;
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        #queryCard {
            position: absolute;
            bottom: 20px; 
            right: 20px; 
            width: 250px; 
            background: white; 
            border-radius: 10px; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 15px; 
            font-family: Arial, sans-serif;
            z-index: 10;
            text-align: center;
        }

        h3 {
            font-size: 16px;
            margin: 0;
        }

        .metric {
            font-size: 24px;
            font-weight: bold;
            color: #2d89ef;
            margin-top: 10px;
        }
        
        #navToChartBtn {
          position: absolute;
          top: 50%;
          left: 20px;
          transform: translateY(-50%);
          z-index: 20;
        }

      #navToChartBtn {
          position: absolute;
          top: 30px;  
          left: 140px; 
          z-index: 10;
        }

        #navToChartBtn button {
          background-color:  #D7B29A;
          color: white;
          padding: 12px 24px; 
          border: none;
          border-radius: 8px;
          font-size: 14px;
          cursor: pointer;
          box-shadow: 0 2px 6px rgba(0,0,0,0.2);
          transition: background-color 0.3s ease;
        }

        #navToChartBtn button:hover {
          background-color: #B98F6A;
        }
  </style>

</head>
  
  
<body class="bg-gray-50 text-gray-800">
 <!-- The global significance of coffee + the global trading chain ‚Üí Background image module -->
  <section class="relative max-w-6xl mx-auto my-12 overflow-hidden rounded-xl shadow-md" data-aos="fade-up">
    
    <!-- background -->
    <div class="absolute inset-0">
      <img src="coffeebg.jpg"  class="w-full h-full object-cover opacity-20" />
      <div class="absolute inset-0 bg-white bg-opacity-60"></div> 
    </div>

    <!-- text -->
    <div class="relative z-10 p-8 space-y-8">
     
      <div>
        <h2 class="section-title">‚òï Introduction to Global Coffee Production</h2>
        <p class="section-text">
          Over the past decade, global coffee production has shown relatively stable patterns, with Brazil, Vietnam, Indonesia, Colombia, and Ethiopia consistently ranking as the top producers. Coffee production can be evaluated through three key indicators: total production volume, yield per hectare, and cultivated area. Total production reflects a country‚Äôs overall output, while yield per hectare indicates land-use efficiency, and cultivated area reveals the extent of land dedicated to coffee farming.
          <ul class="list-disc ml-6">
            <li>üå±<b>Three Indicators in Production:</b></li>
            
            <ul class="list-disc ml-6">
              <li><b>Total production:</b> Brazil has remained the largest producer globally, followed by Vietnam and Colombia. </li>
              <li><b>Yield efficiency: </b>Measured as the amount of coffee produced per hectare, is particularly high in countries such as Malaysia, China, and Vietnam, indicating their ability to achieve high productivity on relatively smaller plots of land.</li>
              <li><b>Cultivated Area: </b> Countries like Brazil, Indonesia, and Ethiopia lead in coffee cultivation area, benefiting from vast arable land suitable for coffee farming. </li>

            </ul>
            <br>

            <li><b>‚òï Relationship Between Three Indicators (Production Volume,Yield efficiency, and Cultivated Area )</b></li>
            <ul class="list-disc ml-6">
            <li>high yield per hectare does not necessarily guarantee high total output. Countries with the highest production often combine large cultivation areas with relatively efficient farming practices, resulting in both high volume and competitive yield levels.</li>

            </ul>
          </ul>
        </p>
      </div>

     
      <div>
        <h2 class="section-title">üåç High-Yield Countries: Malaysia, China, and Vietnam</h2>
        <p class="section-text">
        Over the past decade, Malaysia, China, and Vietnam have consistently recorded the highest coffee yields per hectare among all producing countries. This high productivity can be attributed to several key factors. In Malaysia, modern agricultural practices, including the use of improved seedlings and well-managed smallholder farms, have helped maximize yield despite a limited cultivation area.
          </p>

        <p class="section-text">
          The below map is a visual aid map to show the coffee production trends from 2013 to 2022</p>
      </div>
    </div>

  </section>
  
  
  
<!-- map and the graph -->
<div class="h-[650px] flex">
  <!-- left-selection -->
  


  <div class="flex-1 bg-gay-200 relative">
    <div id="navToChartBtn">
      <button onclick="window.location.href='production plot.html'">parallel coordinates plot</button>
    </div>

    <div id="viewDiv"></div>
    <div id="timeSliderDiv"></div>
    <div id="layerControls">
        <label for="layerSelect"><b>Select factor:  </b></label>
        <select id="layerSelect">
            <option value="layer1">Coffee Production Volume</option>
            <option value="layer2">Coffee Production Volume Per Hectare</option>
            <option value="layer3">Coffee Cultivated Area</option>
        </select>
    </div>
    <div id="queryCard">
        <h3>Coffee Information</h3>
        <div id="queryResult" class="metric">Calculating...</div>
    </div>
  </div>

</div>
  
   


  <section class="max-w-6xl mx-auto mt-10 grid grid-cols-1 md:grid-cols-2 gap-8">
  
  <!-- lefe-coffeetravel-video -->
  <div class="bg-white shadow-lg p-6 rounded-xl" data-aos="fade-up">
    <h2 class="text-xl font-bold mb-2">‚òï Major Coffee Producers: Brazil, Vietnam, and Colombia</h2>
    <p class="text-gray-700 mb-4">
      Brazil, Vietnam, and Colombia have been the dominant players in global coffee production over the past decade, each with distinct strengths that contribute to their sustained output.</p>
      <p class="text-gray-700 mb-4">
        Brazil is the world‚Äôs leading coffee producer, a position it has maintained for decades. The country‚Äôs success is rooted in its vast plantation sizes, suitable climate, and highly mechanized farming systems. Regions like Minas Gerais and Esp√≠rito Santo are known for their large-scale operations, which allow efficient harvesting and processing. Brazil produces both Arabica and Robusta coffee, which enables it to meet a wide range of market demands.</p>
        <p class="text-gray-700 mb-4">
        Vietnam, as noted, is a leader in Robusta production. The government's agricultural policies have strongly supported the coffee sector since the 1990s, encouraging both expansion and modernization. Vietnam's production is dominated by smallholder farms that operate within a highly organized system of cooperatives and exporters, ensuring both consistency and scale in output.</p>
        <p class="text-gray-700 mb-4">
        Colombia is renowned for its premium Arabica coffee and unique growing conditions shaped by the Andes mountains, consistent rainfall, and fertile volcanic soil. While mechanization is limited due to the rugged terrain, Colombia maintains high total output through a combination of widespread smallholder farming and a strong institutional framework, including the National Federation of Coffee Growers, which provides support in quality control and market access.
    </p>

  </div>

  <!-- right-trade view -->
  <div class="bg-white shadow-lg p-6 rounded-xl" data-aos="fade-up">
    <h2 class="text-xl font-bold mb-2">‚òï Countries with Large Cultivated Area: Brazil, Indonesia, and Ethiopia</h2>
    <p class="text-gray-700 mb-4"> In terms of cultivated area, Brazil, Indonesia, and Ethiopia have consistently ranked among the top over the past ten years, largely due to their favorable climates, terrain, and historical ties to coffee cultivation.<br></p>
    <p class="text-gray-700 mb-4">
    Brazil‚Äôs coffee plantations cover expansive areas, particularly in the southeast. Its success is not only due to large land availability but also to investments in agricultural infrastructure and research institutions that guide farmers toward optimal cultivation practices.<br></p>
    <p class="text-gray-700 mb-4">
    Indonesia also dedicates substantial land to coffee, particularly in Sumatra, Java, and Sulawesi. Although yields per hectare are generally lower than in countries like Vietnam, Indonesia‚Äôs large cultivation base supports significant national output. Much of the production is carried out on smallholder plots using traditional methods, which contributes to the country‚Äôs diverse flavor profiles in the specialty coffee market.<br>
    </p>
    <p class="text-gray-700 mb-4">
    Ethiopia, often considered the birthplace of Arabica coffee, has one of the largest cultivation areas in Africa. The country‚Äôs diverse topography and climate zones support a wide range of coffee varieties. Although its farming is primarily non-mechanized and carried out by smallholders, Ethiopia‚Äôs vast coffee-growing regions ensure its place as a major producer, especially in terms of specialty and organic coffee. <br></p>
    
      
  </div>

</section>


<!-- data source -->
<section class="max-w-6xl mx-auto bg-white mt-12 p-6 rounded-xl shadow-md" data-aos="fade-up">
  <h2 class="section-title">üìä Data Sources & References</h2>
  <b>Data Sources:</b>
  <ul class="list-disc ml-6 text-sm text-gray-700 space-y-1">
    <li>Food and Agriculture Organization of the United Nations. (2025). Coffee bean yields ‚Äì FAO [Data set]. In Production: Crops and livestock products. Retrieved April 16, 2025, from https://ourworldindata.org/grapher/coffee-yields</li>
    <li>Natural Earth. (n.d.). Admin 0 ‚Äì Countries [Map data]. Retrieved from https://www.naturalearthdata.com</li>
    <li>QGIS Development Team. (2025). QGIS Geographic Information System (Version 3.36) [Software]. Open Source Geospatial Foundation. Retrieved from https://qgis.org</li>
    <li>Ritchie, H., Rosado, P., & Roser, M. (2023). Agricultural production [Data set]. Our World in Data. Data adapted from Food and Agriculture Organization of the United Nations. Retrieved from https://ourworldindata.org/grapher/coffee-production-by-region</li>
  </ul>
  <br>
  
  <br>
  
  </section>
  <a href="homepage.html"
   class="fixed top-4 right-4 z-50 px-4 py-2 bg-white border border-gray-300 shadow rounded-full text-sm text-gray-800 hover:bg-amber-100 transition">
  üè† Homepage
</a>

  
  <footer class="bg-gray-100 mt-16 py-8 text-sm text-gray-600 border-t">
  <div class="max-w-6xl mx-auto px-4 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
    
    <!-- copyright -->
    <div>
      ¬© 2025 Coffee Trade Insights. All rights reserved.
    </div>

    <!-- social media -->
    <div class="flex space-x-4">
      <a href="#" class="hover:underline">About</a>
      <a href="#" class="hover:underline">GitHub</a>
      <a href="#" class="hover:underline">Privacy Policy</a>
    </div>

    <!-- author -->
    <div>
      Created by <a href="#" class="text-amber-600 font-medium hover:underline">Group 6</a>
    </div>
    
  </div>
</footer>

<script class="section-text">
  
  AOS.init();

        require([
            "esri/Map",
            "esri/views/MapView",
            "esri/layers/FeatureLayer",
            "esri/widgets/TimeSlider",
            "esri/widgets/ScaleBar",
            "esri/widgets/Legend",
            "esri/widgets/Compass",
            "esri/widgets/Search",
            "esri/Color",
        ], function(Map, MapView, FeatureLayer, TimeSlider, ScaleBar, Legend, Compass, Search,Color) {

     
     
            
            const layer1 = new FeatureLayer({
                url: "https://services5.arcgis.com/KiRa9d9aHfdXiCqt/arcgis/rest/services/Coffee_Production_Information/FeatureServer",
                outFields: ["Year_date","Year", "Production_tonnes","Country"],
                popupTemplate: {
                    title: "Coffee Production Information",
                    outFields: ["*"],
                    expressionInfos: [
                        {
                          name: "expr0",
                          title: "Year Only",
                          expression: "Year($feature.Year_date)"
                        }
                      ],
                    fieldInfos: [
                      //Add digitSeparator for population column
                      {
                        fieldName: "Production_tonnes",
                        visible: true,
                        label: "Production Volume (tonnes)",
                        format: {
                          places: 0,
                          digitSeparator: true
                        }
                      },
                   
                        ],
          
                    content: [ 
                      {
                       type: "text",
                        text: `
                        <b>Country: </b>{Country}<br>
                        <b>YearÔºö</b> {expression/expr0}<br>
                        <b>Production Volume (tonnes)Ôºö</b> {Production_tonnes}
                        `
                      },  
                      
                        
                      ],   
                        
                     
                        
                       
                },
                renderer: {
                    type: "simple",
                    symbol: {
                        type: "simple-marker",
                        color: "blue",
                        outline: { color: "white", width: 1 }
                    },
                    visualVariables: [
                        {
                            type: "size",
                            field: "Production_tonnes",
                            minDataValue: 10000,
                            maxDataValue: 500000,
                            minSize: 4,
                            maxSize: 40
                        }
                    ]
                },
                timeInfo: {
                    startField: "Year_date",
                    interval: { unit: "years", value: 1 },
                    fullTimeExtent: {
                        start: new Date("2013/01/01"),
                        end: new Date("2022/01/01")
                    }
                }
            });

            const layer2 = new FeatureLayer({
                url: "https://services5.arcgis.com/KiRa9d9aHfdXiCqt/arcgis/rest/services/Coffee_Production_Information/FeatureServer",
                outFields: ["Year_date","Year", "Production_tonnesperhectare","Country"],
                popupTemplate: {
                    title: "Coffee Production Information",
                    outFields: ["*"],
                    expressionInfos: [
                        {
                          name: "expr0",
                          title: "Year Only",
                          expression: "Year($feature.Year_date)"
                        }
                      ],
                    fieldInfos: [
                    
                      {
                        fieldName: "Production_tonnesperhectare",
                        visible: true,
                        label: "Production Volume Per Hectare (tonnes/hectare)",
                        format: {
                          places: 2,
                          digitSeparator: true
                        }
                      },
                        
                        ],
          
                    content: [ 
                      {
                        type: "text",
                        text: `
                        <b>Country: </b>{Country}<br>
                        <b>YearÔºö</b> {expression/expr0}<br>
                        <b>Production Volume Per Hectare (tonnes/hertare)Ôºö</b> {Production_tonnesperhectare}
                        `
                      },  
                      
                        
                      ],
                 
                
                },
                renderer: {
                    type: "simple",
                    symbol: {
                        type: "simple-marker",
                        color: "green",
                        outline: { color: "white", width: 1 }
                    },
                    visualVariables: [
                        {
                            type: "size",
                            field: "Production_tonnesperhectare",
                            minDataValue: 0.03,
                            maxDataValue: 3,
                            minSize: 4,
                            maxSize: 40
                        }
                    ]
                },
                timeInfo: {
                    startField: "Year_date",
                    interval: { unit: "years", value: 1 },
                    fullTimeExtent: {
                        start: new Date("2013/01/01"),
                        end: new Date("2022/01/01")
                    }
                }
            });

            const layer3 = new FeatureLayer({
                url: "https://services5.arcgis.com/KiRa9d9aHfdXiCqt/arcgis/rest/services/Coffee_Production_Information/FeatureServer",
                outFields: ["Year_date","Year", "Cultivated_hectare","Country"],
                
                popupTemplate: {
                    title: "Coffee Production Information",
                    outFields: ["*"],
                    expressionInfos: [
                        {
                          name: "expr0",
                          title: "Year Only",
                          expression: "Year($feature.Year_date)"
                        }
                      ],
                    fieldInfos: [
                        {
                        fieldName: "Cultivated_hectare",
                        visible: true,
                        label: "Coffee Cultivated Area (hectares)",
                        format: {
                          places: 0,
                          digitSeparator: true
                        }
                      },
                        ],
          
                    content: [ 
                      {
                        type: "text",
                        text: `
                        <b>Country: </b>{Country}<br>
                        <b>YearÔºö</b> {expression/expr0}<br>
                        <b>Coffee Cultivated Area (hectares)Ôºö</b> {Cultivated_hectare}
                        `
                      },  
                      
                        
                      ],
                        
                        
                   
                },
                renderer: {
                    type: "simple",
                    symbol: {
                        type: "simple-marker",
                        color: "red",
                        outline: { color: "white", width: 1 }
                    },
                    visualVariables: [
                        {
                            type: "size",
                            field: "Cultivated_hectare",
                            minDataValue: 100,
                            maxDataValue: 1000000,
                            minSize: 4,
                            maxSize: 40
                        }
                    ]
                },
                timeInfo: {
                    startField: "Year_date",
                    interval: { unit: "years", value: 1 },
                    fullTimeExtent: {
                        start: new Date("2013/01/01"),
                        end: new Date("2022/01/01")
                    }
                }
            });

            const map = new Map({
                basemap: "streets",
                layers: [layer1]
            });

            const view = new MapView({
                container: "viewDiv",
                map: map,
                center: [58.10280833441597, 22.513590742105453],
                zoom: 2
            });
            
            view.when(() => {
                const timeSlider = new TimeSlider({
                    container: "timeSliderDiv",
                    view: view,
                    fullTimeExtent: layer1.timeInfo.fullTimeExtent,
                    mode: "instant",
                    stops: { interval: { value: 1, unit: "years" } },
                    playRate: 1000
                });
                
               
                let activeLayer = layer1; // default layer
                let queryField = "Production_tonnes"; // default query column
                let unitLabel = "tonnes"; // default unit
                let layerName = "Total Production Volume ";
                // Add scale bar
                const scaleBar = new ScaleBar({
                    view: view,
                    unit: "metric"
                });
                view.ui.add(scaleBar, { position: "bottom-left" });

                // Add search function
                const search = new Search({
                    view: view
                });
                view.ui.add(search, "top-right");

                // Add legend
                const legend = new Legend({
                    view: view,
                    layerInfos: [
                    {
                      layer: layer1,
                      title: "Coffee Produntion Information"
                    },
                    {
                      layer: layer2,
                      title: "Coffee Produntion Information"
                    },
                    {
                      layer: layer3,
                      title: "Coffee Produntion Information"
                    }
                 ],
                });
                view.ui.add(legend, "top-right");

                // Add compass
                const compass = new Compass({
                    view: view
                });
                view.ui.add(compass, "top-left");

              

                // Query and Update result
                function queryAndUpdateResult(year) {
                    activeLayer.queryFeatures({
                        where: `Year_date >= DATE '${year}-01-01' AND Year_date < DATE '${year + 1}-01-01'`,
                        outFields: ["Country", queryField],
                        orderByFields: `${queryField} DESC`,
                        num: 5, // return top5 result
                        returnGeometry: false
                    }).then(function(result) {
                        // Sum function
                        const totalValue = result.features.reduce((sum, feature) => {
                            return sum + feature.attributes[queryField];
                        }, 0);
                       
                        
                        // Top5 countries data
                        const topCountries = result.features.map(feature => ({
                            country: feature.attributes.Country,
                            value: feature.attributes[queryField]
                        }));

                        // 
                        console.log("Top 5 Countries:", topCountries);

                        // update title 
                        const queryCardTitle = document.querySelector("#queryCard h3");
                        queryCardTitle.textContent = `${year}  ${layerName}`;
                        const resultDiv = document.getElementById("queryResult");
                        
                        if (activeLayer === layer2) { 
                          const meanValue = totalValue / result.features.length;
                          resultDiv.textContent = `${meanValue.toLocaleString()} ${unitLabel}`;
                        
                        } else {
                          
                          resultDiv.textContent = `${totalValue.toLocaleString()} ${unitLabel}`;
                        }
                        
                        
                        
                      

                        // Show top5 countries
                        let countryListDiv = document.getElementById("countryListDiv");
                        if (!countryListDiv) {
                            countryListDiv = document.createElement("div");
                            countryListDiv.id = "countryListDiv";
                            countryListDiv.style.cssText = "position: absolute; top:1150px; right: 15px; width: 280px; background: white; border-radius: 5px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); padding: 10px;";
                            document.body.appendChild(countryListDiv);
                        }

                        let content = `<h3>Top 5 Countries in ${year}:</h3><ol>`;
                        topCountries.forEach(item => {
                            content += `<li><strong>${item.country}:</strong> ${item.value.toLocaleString()} ${unitLabel}</li>`;
                        });
                        content += "</ol>";
                        countryListDiv.innerHTML = content;
                    }).catch(function(error) {
                        console.error("Query FailedÔºö", error);
                        document.getElementById("queryResult").textContent = "Query Failed";
                    });
                
                }
                       
                        
                // Update Time Slider year and query
                timeSlider.watch("timeExtent", function (value) {
                    const year = value.start.getFullYear();
                    queryAndUpdateResult(year);
                });

                // layer switch function
                document.getElementById("layerSelect").addEventListener("change", function (event) {
                    const selectedLayer = event.target.value;
                    map.layers.removeAll();

                    if (selectedLayer === "layer1") {
                        activeLayer = layer1;
                        queryField = "Production_tonnes";
                        layerName = "Total Production Volume";
                        unitLabel = "tonnes";
                    } else if (selectedLayer === "layer2") {
                        activeLayer = layer2;
                        queryField = "Production_tonnesperhectare";
                        layerName = "Average Productivity";
                        unitLabel = "t/ha";
                    } else if (selectedLayer === "layer3") {
                        activeLayer = layer3;
                        queryField = "Cultivated_hectare";
                        layerName = "Total Cultivated Area";
                        unitLabel = "hectare";
                    }

                    // Add the selected layer to the map
                    map.layers.add(activeLayer);
                    timeSlider.fullTimeExtent = activeLayer.timeInfo.fullTimeExtent;

                    // Activate Query (year)
                    const year = timeSlider.timeExtent.start.getFullYear();
                    queryAndUpdateResult(year);
                });

                // default query and time sldier
                layer1.when(() => {
                    timeSlider.timeExtent = {
                        start: new Date("2013-01-01"),
                        end: new Date("2013-12-31")
                    };
                });
            });


            
            
        });
    </script>

</body>
</html>
